argocdNamespace: default

lgtm:
  enabled: true
  version: 3.0.1
  grafana:
    enabled: true
    ingress:
      enabled: true
      host: grafana.gsingh.io
    admin:
      existingSecret: grafana-admin-credentials
      userKey: admin-user
      passwordKey: admin-password
  loki:
    enabled: true
    gateway:
      ingress:
        enabled: false
        host: loki-gateway.gsingh.io
    s3:
      enabled: true
      existingSecret: loki-s3-credentials
      retentionPeriod: 30d
  mimir:
    enabled: true
    s3:
      enabled: false
      existingSecret: loki-s3-credentials
  tempo:
    enabled: true
    s3:
      enabled: false
      existingSecret: loki-s3-credentials

alloy:
  enabled: true
  version: 1.0.3

authentik:
  enabled: false
  version: "2025.10.3"
  namespace: default
  existingSecret: authentik-secret
  # External PostgreSQL configuration
  postgresql:
    host: 192.168.2.119
    port: 5432
    database: authentik
    username: authentik
  trusted_proxy_cidrs:
    "192.168.0.0/16"
    # Password is read from existingSecret
  # Email settings (optional, leave disabled if not needed)
  email:
    enabled: false
    host: ""
    port: 587
    username: ""
    from: ""
    use_tls: false
  # Error reporting (optional)
  error_reporting:
    enabled: false
    environment: "production"
  # Log level
  log_level: "info"
  # Server configuration
  server:
    replicas: 1
  # Worker configuration
  worker:
    replicas: 1
  # Ingress configuration
  ingress:
    enabled: true
    host: authentik.gsingh.io
  tls:
    enabled: true

airflow:
  enabled: false
  version: "25.0.2" # Bitnami Airflow Helm chart version
  namespace: default
  global:
    security:
      allowInsecureImages: true
  image:
    registry: regv2.gsingh.io
    repository: core/airflow
    tag: 3.0.5
  auth:
    existingSecret: airflow-secrets
    # username: user
    # password: airflow
    # fernetKey: ""
    # secretKey: ""
  executor: CeleryExecutor
  loadExamples: false
  ingress:
    enabled: true
    host: airflow.gsingh.io
    # ingressClassName: nginx
    annotations: {}
    tls: false
  postgresql:
    enabled: false # Use external PostgreSQL
    image:
      registry: regv2.gsingh.io
      repository: core/postgresql
      tag: "16.4"
  externalDatabase:
    host: 192.168.2.119
    port: 5432
    database: airflow
    existingSecret: airflow-db-secret
    # user: airflow
    # password: airflow
  redis:
    enabled: false # Use external Redis
    image:
      registry: regv2.gsingh.io
      repository: core/redis
      tag: "7.4"
  dags:
    gitSync:
      enabled: false
      repo: "" # Git repository URL for DAGs
      branch: main
      name: dags
      path: ""
      # sshKeySecret: ""
  # webserverReplicaCount: 1
  # schedulerReplicaCount: 1
  # workerReplicas: 1
  usePasswordFiles: true

argowf:
  enabled: false
  version: 0.45.6
  ingress:
    host: argowf.gsingh.io
  sso:
    issuer: https://auth.gsingh.io
    redirectUrl: https://argowf.gsingh.io/oauth2/callback

argocd:
  enabled: true
  # Sync policy configuration for ArgoCD self-management
  # Set automated to false to disable auto-sync (requires manual sync)
  # Set selfHeal to false to disable drift correction
  syncPolicy:
    automated: true # Enable/disable automatic sync
    selfHeal: true # Enable/disable self-healing on drift
    prune: true # Enable/disable automatic pruning of resources

coder:
  enabled: true
  version: 2.29.6
  ingress:
    host: ide.gsingh.io
  accessUrl: https://ide.gsingh.io
  oidc:
    ignoreEmailVerified: true
    signInText: "SSO Login"

fission:
  enabled: true
  version: "1.22.1"
  namespace: fission
  routerServiceType: ClusterIP
  # Canary deployments (requires prometheus.serviceEndpoint)
  canaryDeployment:
    enabled: false
  # OpenTelemetry tracing -- sends traces to Tempo via OTLP gRPC
  openTelemetry:
    otlpCollectorEndpoint: "lgtm-tempo.default.svc.cluster.local:4317"
    otlpInsecure: true
    tracesSampler: "parentbased_traceidratio"
    tracesSamplingRate: "0.1"
  # Prometheus ServiceMonitor for Mimir scraping
  serviceMonitor:
    enabled: true
    namespace: fission
  # Ingress for Fission router
  ingress:
    enabled: true
    host: fission.gsingh.io
  # OAuth2 Proxy for Fission (reverse proxy mode)
  # Supports both browser (session) and programmatic (JWT bearer token) access
oauth2ProxyFission:
  enabled: true
  version: "10.1.2"
  namespace: fission
  existingSecret: oauth2-proxy-fission-secret
  ingress:
    enabled: true
    host: fission.gsingh.io
    className: traefik
  extraArgs:
    provider: "oidc"
    oidc-issuer-url: "https://auth.gsingh.io"
    email-domain: "*"
    upstream: "http://router.fission.svc.cluster.local"
    redirect-url: "https://fission.gsingh.io/oauth2/callback"
    scope: "openid profile email"
    skip-provider-button: "true"
    skip-jwt-bearer-tokens: "true"
    pass-authorization-header: "true"
    pass-access-token: "true"

ghost:
  enabled: false
  version: 24.0.1
  ghostHost: ghost.gsingh.io
  ingress:
    hostname: blog.gsingh.io
  ghostEmail: hello@gsingh.io

langfuse:
  enabled: true
  version: 1.5.18
  ingress:
    host: langfuse.gsingh.io
  clickhouse:
    enabled: true
    deploy: true
    migration:
      autoMigrate: true

protonbridge:
  enabled: false
  version: 5.4.2

rancher:
  enabled: true
  version: 2.11.2
  hostname: rancher.gsingh.io

rootapp:
  enabled: true

uptime:
  enabled: true
  version: 2.24.0
  ingress:
    host: uptime.gsingh.io

whoami:
  enabled: false

fissionHello:
  enabled: false

openproject:
  enabled: false
  admin_user:
    password_reset: false
    name: "gurbakhshish"
    mail: "hello@gsingh.io"
    secret: openproject-admin-secrets
  s3:
    enabled: true
    existingSecret: openproject-s3-secrets
    bucketName: gsingh19-openproject
    # endpoint: https://s3.gsingh.io
  appInit:
    resources:
      limits:
        memory: "1Gi"
      requests:
        memory: "1Gi"
  version: 10.3.0
  ingress:
    enabled: true
    host: projects.gsingh.io
  postgresql:
    bundled: false
    host: 192.168.2.119
    database: openproject
    username: openprojectuser
  oidc:
    enabled: false # Set to true to enable OIDC authentication
    provider: "Zitadel"
    displayName: "Zitadel SSO"
    host: "auth.gsingh.io"
    scope: "[openid profile email]"

zitadel:
  enabled: true
  version: 9.17.1
  externalDomain: auth.gsingh.io
  ingress:
    host: auth.gsingh.io
  masterkeySecretName: zitadel-masterkey
  configSecretName: zitadel-secrets
  login:
    enabled: true
    ingress:
      enabled: true

windmill:
  enabled: false
  version: 4.0.21
  host: windmill.gsingh.io
  postgresql:
    enabled: false
  databaseSecret:
    name: windmill-secrets
    key: database-url
    enabled: false

promtail:
  enabled: true
  version: 6.17.0
  config:
    clients:
      - url: http://lgtm-loki-gateway.default.svc.cluster.local:80/loki/api/v1/push
  resources:
    limits:
      cpu: 200m
      memory: 128Mi
    requests:
      cpu: 100m
      memory: 128Mi

k8sMonitoring:
  enabled: false
  version: 3.5.7
  # LGTM Stack endpoints
  endpoints:
    loki: http://lgtm-loki-gateway.default.svc.cluster.local:80/loki/api/v1/push
    mimir: http://lgtm-mimir.default.svc.cluster.local:9009/api/v1/push
    tempo: http://lgtm-tempo.default.svc.cluster.local:4318
  # Cluster metrics collection
  clusterMetrics:
    enabled: true
    kubeStateMetrics:
      enabled: true
    nodeExporter:
      enabled: true
    windowsExporter:
      enabled: false
    opencost:
      enabled: false
    kepler:
      enabled: false
  # Logs collection
  logs:
    enabled: true
    podLogs:
      enabled: true
    nodeLogs:
      enabled: true
    clusterEvents:
      enabled: true
  # Application observability
  applicationObservability:
    enabled: true
    otlp:
      enabled: true
  # Traces collection
  traces:
    enabled: true
  # Metrics configuration
  metrics:
    enabled: true
    cost:
      enabled: false

kyuubi:
  enabled: false
  namespace: default
  replicaCount: 2
  image:
    repository: apache/kyuubi
    tag: "1.10.2-all"
  resources:
    limits:
      cpu: 2
      memory: 4Gi
    requests:
      cpu: 1
      memory: 2Gi

trino:
  enabled: true
  version: "1.42.0"
  namespace: data-platform
  ingress:
    host: trino.gsingh.io
  server:
    workers: 4
  auth:
    enabled: true
    passwordAuthSecret: "trino-password-auth"
    sharedSecretName: "trino-shared-secret"
    groups:
      enabled: false
      groupsAuthSecret: "trino-groups-auth"
  catalogs:
    iceberg:
      enabled: true
      catalogName: iceberg
      warehouse: s3a://datastore/iceberg
      s3:
        endpoint: https://s3v2.gsingh.io
        region: us-east-1
        pathStyleAccess: true
      credentialsSecret: trino-iceberg-s3

dagster:
  enabled: true
  version: 1.12.13
  namespace: dagster
  ingress:
    host: dagster.gsingh.io
    ingressClassName: traefik
    annotations: {}
    # Optional: Add Traefik-specific annotations if needed
    # annotations:
    #   traefik.ingress.kubernetes.io/router.entrypoints: websecure
    #   traefik.ingress.kubernetes.io/router.tls: "true"
  postgresql:
    enabled: false
    host: 192.168.2.119
    username: dagster
    database: dagster
    existingSecret: dagster-postgresql-secret
  # User code deployments - supports multiple deployments
  userDeployments:
    enabled: true
    # Global image pull secrets applied to all deployments (can be overridden per deployment)
    imagePullSecrets:
      - regv2-secret
    # List of user code deployments
    deployments:
      - name: "sample-dagster"
        image:
          repository: regv2.gsingh.io/personal/sample-dagster
          tag: latest
          pullPolicy: Always
        # For modern Dagster projects (uv/module-based), use moduleName
        moduleName: sample_dagster
        # For legacy projects (file-based), use codeFile instead
        # codeFile: /apps/sample-dagster/main.py
        # Optional: Override global imagePullSecrets for this deployment
        # imagePullSecrets:
        #   - custom-secret
      # Example: Add more deployments as needed
      # - name: "analytics-pipeline"
      #   image:
      #     repository: regv2.gsingh.io/personal/analytics-dagster
      #     tag: v1.0.0
      #     pullPolicy: IfNotPresent
      #   moduleName: analytics_pipeline

oauth2Proxy:
  enabled: true
  version: "10.1.2"
  namespace: dagster
  existingSecret: oauth2-proxy-dagster-secret
  ingress:
    enabled: true
    host: dagster.gsingh.io
    className: traefik
    annotations: {}
  extraArgs:
    provider: "oidc"
    oidc-issuer-url: "https://auth2.gsingh.io"
    email-domain: "*"
    upstream: "http://dagster-dagster-webserver.dagster.svc.cluster.local"
    redirect-url: "https://dagster.gsingh.io/oauth2/callback"
    scope: "openid profile email"
    skip-provider-button: "true"

prefect:
  enabled: true
  version: "2026.1.30002458"
  namespace: prefect
  ingress:
    host: prefect.gsingh.io
    tls: true
    selfSigned: true
  postgresql:
    useEmbedded: false
    existingSecret: "prefect-db-secret"
  basicAuth:
    enabled: true
    existingSecret: "prefect-basic-auth"
  uiApiUrl: "https://prefect.gsingh.io/api"
  # Custom image (uncomment and set to use custom registry)
  image:
    repository: regv2.gsingh.io/core/prefect_ext
    tag: "3.6.10-python3.11_0.0.1"
    pullSecrets: ["regv2-secret"]

prefectWorker:
  enabled: true
  version: "2026.1.30002458"
  namespace: prefect
  replicaCount: 5
  workPool: "kubernetes"
  apiUrl: "https://prefect.gsingh.io/api"
  basicAuth:
    enabled: true
    existingSecret: "prefect-basic-auth"
  # Custom image (uncomment and set to use custom registry)
  image:
    repository: regv2.gsingh.io/core/prefect_ext
    tag: "kube_worker"
    pullSecrets: ["regv2-secret"]
  #   debug: false

  # RBAC configuration for Kubernetes worker
  # These permissions allow the worker to create and manage Kubernetes resources
  # for flow runs using prefect_kubernetes.jobs.KubernetesJob
  role:
    extraPermissions:
      # Allow worker to create, update, and delete pods for flow runs
      - apiGroups: [""]
        resources: ["pods", "pods/log", "pods/status"]
        verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
      # Allow worker to manage services (for flow run networking)
      - apiGroups: [""]
        resources: ["services"]
        verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
      # Allow worker to manage configmaps (for flow run configuration)
      - apiGroups: [""]
        resources: ["configmaps"]
        verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
      # Allow worker to read events for monitoring
      - apiGroups: [""]
        resources: ["events"]
        verbs: ["get", "list", "watch"]
      # Allow worker to manage persistent volume claims (for flow run storage)
      - apiGroups: [""]
        resources: ["persistentvolumeclaims"]
        verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
